<h3 mat-dialog-title *ngIf="dateNull == false"> Schedule Event on - {{this.datex | date:'fullDate' }} </h3>
<h3 mat-dialog-title *ngIf="dateNull == true"> PlanEvent</h3>

<mat-dialog-content class="mat-typography">
  <div class="container ">
    <mat-form-field>
    <mat-select placeholder="TimeSettings" *ngIf="showScheduler == true" [(ngModel)]="timeSetting">
    <!-- <mat-option value="Duration">duration basedAppt</mat-option> -->
    <mat-option value="Appointment">Appointment</mat-option>
    <mat-option value="Task">Task</mat-option>
    <mat-option value="Event">Event</mat-option>

    </mat-select>

    </mat-form-field>
    <mat-checkbox style="margin-left:10px; padding:5px" [(ngModel)]="recurrence">Recuring Event </mat-checkbox>

    <mat-form-field *ngIf="recurrence == true" style="padding:5px">
    <mat-select placeholder="RecurringEvery"  [(ngModel)]="recurrenceFreq">
    <mat-option value="Month">Monthly</mat-option>
    <mat-option value="Week">Weekly</mat-option>
    <mat-option value="Daily">Everyday</mat-option>
    </mat-select>

    </mat-form-field>

    <mat-form-field *ngIf=" recurrence == true && recurrenceFreq == 'Week'"  style="padding:5px">
    <mat-select placeholder="RecurringEvery" [(ngModel)]="recurrenceWeek" multiple>
    <mat-option value="Monday">Monday</mat-option>
    <mat-option value="Tuesday">Tuesday</mat-option>
    <mat-option value="Wednesday">Wednesday</mat-option>
    <mat-option value="Thursday">Thursday</mat-option>
    <mat-option value="Friday">Friday</mat-option>

    </mat-select>

    </mat-form-field>

    <mat-form-field  *ngIf=" recurrence == true && recurrenceFreq == 'Month'">
      <mat-select placeholder="RecurringEvery" [(ngModel)]="recurrenceMonth" multiple>
      <mat-option value="-1"> Last Day of the Month</mat-option>
      <mat-option *ngFor="let item of DayList"value="item">{{item}}</mat-option>


      </mat-select>
    </mat-form-field>

    <mat-form-field *ngIf=" recurrence == true && recurrenceFreq == 'Daily'">

      <input matInput placeholder="Interval" min="1" [(ngModel)]="recurrenceDay" [formControl]="rateControl">
      <mat-error>Range 1-100 (1 is everyday)</mat-error>

    </mat-form-field>

  </div>



<!--
  <div style="margin: 10px 0;"class="btn-group float-right" role="group" aria-label="Basic example">

    <button class="   btn btn-primary"  (click) ='scheduleEventshow()' > Schedule Event</button>
  <button class="   btn btn-primary"  (click) ='sendMessage()' > Add Task</button>
</div>

  <br> -->

<div class="" *ngIf="this.showScheduler== true">
  <div class="container-fluid " style="padding:20px">

    <table class="example-full-width" cellspacing='0'>
      <tr>
        <td>
          <mat-form-field class="example-full-width">
            <input matInput placeholder="Title" value=" Event on {{clickedDate}}">
          </mat-form-field>

  </td>
  <td *ngIf="timeSetting == 'Appointment'   " style="margin:10px">

        <input
          class="form-control"
          type="text"
          mwlFlatpickr
          [(ngModel)]="jsonEvent.start"
          (ngModelChange)="refresh.next()"
          [altInput]="true"
          [convertModelValue]="true"
          [enableTime]="true"
          dateFormat="Y-m-dTH:i"
          altFormat="F j, Y H:i"
          placeholder='Click to enter Start Date'>
</td>
<td *ngIf="timeSetting == 'Duration'">

        <mat-form-field >
          <input matInput [matDatepicker]="picker1" placeholder="Date" [(ngModel)]="jsonEvent.start">
          <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
          <mat-datepicker #picker1></mat-datepicker>
        </mat-form-field>
</td>

      <td style='width:20%' *ngIf="timeSetting == 'Duration' || timeSetting == 'Event'" >



        <mat-form-field >
          <input matInput  type='time' placeholder="Duration" [(ngModel)]="jsonEvent.duration" >
        </mat-form-field>
</td>

<td *ngIf="timeSetting == 'Appointment' || timeSetting == 'Task' " style="padding:10px">
  <input
    class="form-control"
    type="text"
    mwlFlatpickr
    [(ngModel)]="jsonEvent.end"
    (ngModelChange)="refresh.next()"
    [altInput]="true"
    [convertModelValue]="true"
    [enableTime]="true"
    dateFormat="Y-m-dTH:i"
    altFormat="F j, Y H:i"
    placeholder="Click to edit EndTime">

</td>

<td *ngIf="timeSetting == 'Duration'">
        <mat-form-field>
    <mat-select placeholder="Click to Edit" [(value)]="jsonEvent.durationUnit" [(ngModel)]="jsonEvent.durationUnit">
      <mat-option value="Minutes">Minutes</mat-option>
      <mat-option value="Hours">Hours</mat-option>
      <mat-option value="FullDay">FullDay</mat-option>
    </mat-select>

  </mat-form-field>

</td>
    </tr>

    </table>

    <mat-form-field class="example-full-width">
  <mat-label>Description</mat-label>
  <textarea matInput
            cdkTextareaAutosize
            #autosize="cdkTextareaAutosize"
            cdkAutosizeMinRows="2"
            cdkAutosizeMaxRows="7"
            [(ngModel)]="jsonEvent.description"
            ></textarea>
</mat-form-field>

<table>
  <tr>
    <td><mat-form-field>
  <mat-select placeholder="Prioity" [(value)]="jsonEvent.priority" [(ngModel)]="jsonEvent.priority">
    <mat-option value="High">High</mat-option>
    <mat-option value="Normal">Normal</mat-option>
    <mat-option value="Low">Low</mat-option>
  </mat-select>
</mat-form-field></td>

    <td>
<label for="#buddies"> Select Associates:  </label>
    </td>
      <td>
        <ng-multiselect-dropdown style="min-width: 300px"
        id="buddies"
      [placeholder]="'custom placeholder'"
      [data]="dropdownList"
      [(ngModel)]="selectedItems"
      [settings]="dropdownSettings"
      (onSelect)="onItemSelect($event)"
      (onSelectAll)="onSelectAll($event)"
      [(ngModel)]="jsonEvent.with"
      >
      </ng-multiselect-dropdown>


    </td>

  </tr>

  <tr>
    <td>
      <button mat-button class="btn" name="button"> Attach Documents</button>
    </td>
  </tr>
</table>

    <!-- <div class="btn-group float-center">
      <button class="btn" name="button">Cancel</button>
      <button class="btn" name="button">CheckAvailability</button>

    </div> -->
  </div>

</div>
<div *ngIf="this.showEvents == false && this.showScheduler==false">
    <h3 style="color:red"> NoEvents! </h3>
</div>

<div *ngIf="this.showEvents===true">
  <table class=" example-full-width table table-bordered">

    <thead>
      <tr>
        <th>Title</th>
        <th>Starts at</th>
        <th>Ends at</th>
        <th> With </th>
        <th>Actions</th>

      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let event of events; let index = index">
        <td>
          <input
            type="text"
            class="form-control"
            [(ngModel)]="event.title"
            (keyup)="refresh.next()">
        </td>
        <td>
          <input
            class="form-control"
            type="text"
            mwlFlatpickr
            [(ngModel)]="event.start"
            (ngModelChange)="refresh.next()"
            [altInput]="true"
            [convertModelValue]="true"
            [enableTime]="true"
            dateFormat="Y-m-dTH:i"
            altFormat="F j, Y H:i"
            placeholder="Not set">
        </td>
        <td>
          <input
            class="form-control"
            type="text"
            mwlFlatpickr
            [(ngModel)]="event.end"
            (ngModelChange)="refresh.next()"
            [altInput]="true"
            [convertModelValue]="true"
            [enableTime]="true"
            dateFormat="Y-m-dTH:i"
            altFormat="F j, Y H:i"
            placeholder="Not set">
        </td>
        <td>
          <ng-multiselect-dropdown
  [placeholder]="Invitee"
  [data]="dropdownList"
  [(ngModel)]="event.with"
  [settings]="dropdownSettings"
  (onSelect)="onItemSelect($event)"
  (onSelectAll)="onSelectAll($event)">
</ng-multiselect-dropdown>

        </td>
        <td>
          <i class="fa fa-fw fa-times" (click)="events.splice(index, 1); refresh.next(); id= id-1;"></i>
        </td>
      </tr>
    </tbody>

  </table>

</div>

 </mat-dialog-content>
<mat-dialog-actions align="end">
  <button mat-button mat-dialog-close>Cancel</button>
  <button mat-button *ngIf="showScheduler == false" (click) ='sendMessage()'  [mat-dialog-close]="true" cdkFocusInitial>Done</button>
  <button mat-button *ngIf="showScheduler == true" (click) ='scheduleEvent()'  [mat-dialog-close]="true" cdkFocusInitial>Schedule Event</button>

</mat-dialog-actions>
